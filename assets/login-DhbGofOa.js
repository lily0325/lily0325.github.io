var ae=Object.defineProperty;var re=(s,n,a)=>n in s?ae(s,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[n]=a;var w=(s,n,a)=>(re(s,typeof n!="symbol"?n+"":n,a),a);import{_ as B,e as D,f as ie,u as le,g as ce,d as de,h as ue,j as pe,A as me}from"./index-BwT0Twmy.js";import{a2 as u,a3 as h,a7 as o,d as W,ab as k,ac as c,k as i,u as e,G as x,V as _e,r as he,s as E,f as ge,ap as fe,o as ve,j as we,af as v,ag as I,F as S,al as xe,a5 as be,a6 as ye}from"./vue-CUuKurUo.js";import{f as $e,M as ke,D as Me,y as Ce,z as ze,B as Le,I as qe,E as Ae,F as Ee,H as Ie,J as Se,K as Be,U as Ne,N as F,O as Te}from"./antd-DS5P5d4E.js";var Ue=async(s=0)=>new Promise(n=>{const a=setTimeout(()=>{n(!0),clearTimeout(a)},s)});const Pe={name:"CarbonTranslate"},Re={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},Ve=o("path",{fill:"currentColor",d:"M27.85 29H30l-6-15h-2.35l-6 15h2.15l1.6-4h6.85zm-7.65-6l2.62-6.56L25.45 23zM18 7V5h-7V2H9v3H2v2h10.74a14.71 14.71 0 0 1-3.19 6.18A13.5 13.5 0 0 1 7.26 9h-2.1a16.47 16.47 0 0 0 3 5.58A16.84 16.84 0 0 1 3 18l.75 1.86A18.47 18.47 0 0 0 9.53 16a16.92 16.92 0 0 0 5.76 3.84L16 18a14.48 14.48 0 0 1-5.12-3.37A17.64 17.64 0 0 0 14.8 7z"},null,-1),He=[Ve];function Fe(s,n,a,m,p,g){return u(),h("svg",Re,He)}const Oe=B(Pe,[["render",Fe]]),je={hover:"bg-[var(--hover-color)]",flex:"","items-center":"","h-48px":"","px-12px":"","text-16px":"","cursor-pointer":"",class:"transition-all-300"},De=o("span",null," 🇨🇳 ",-1),We=o("span",null," 🇺🇸 ",-1),Ye=W({__name:"index",setup(s){const{locale:n,setLocale:a}=D();function m({key:p}){a(p)}return(p,g)=>{const M=Oe,r=$e,l=ke,b=Me;return u(),k(b,null,{overlay:c(()=>[i(l,{"selected-keys":[e(n)],onClick:m},{default:c(()=>[i(r,{key:"zh-CN"},{icon:c(()=>[De]),default:c(()=>[x(" 简体中文 ")]),_:1}),i(r,{key:"en-US"},{icon:c(()=>[We]),default:c(()=>[x(" English ")]),_:1})]),_:1},8,["selected-keys"])]),default:c(()=>[o("span",je,[i(M,{class:"anticon"})])]),_:1})}}}),Ze={name:"CarbonSun"},Ge={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},Je=o("path",{fill:"currentColor",d:"M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6ZM5.394 6.813L6.81 5.399l3.505 3.506L8.9 10.319zM2 15.005h5v2H2zm3.394 10.193L8.9 21.692l1.414 1.414l-3.505 3.506zM15 25.005h2v5h-2zm6.687-1.9l1.414-1.414l3.506 3.506l-1.414 1.414zm3.313-8.1h5v2h-5zm-3.313-6.101l3.506-3.506l1.414 1.414l-3.506 3.506zM15 2.005h2v5h-2z"},null,-1),Ke=[Je];function Qe(s,n,a,m,p,g){return u(),h("svg",Ge,Ke)}const Xe=B(Ze,[["render",Qe]]),et={name:"CarbonMoon"},tt={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},ot=o("path",{fill:"currentColor",d:"M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3Z"},null,-1),st=[ot];function nt(s,n,a,m,p,g){return u(),h("svg",tt,st)}const at=B(et,[["render",nt]]),rt="/assets/ttm-logo-CSBs4cOc.png",it="/assets/login-left-YYnMV6bm.png";function lt(s,n=""){var p;const a=((p=ie.currentRoute.value)==null?void 0:p.query)??{},m=Ce(a,s)??n;return decodeURIComponent(m)}const t={width:0,height:0,canvas:null,ctx:null,circles:[],animate:!0,requestId:null},ct=function(s){if(!t||!s)throw new Error("no canvasInstance");t.width=window.innerWidth,t.height=window.innerHeight,t.canvas=s,t.canvas.width=t.width,t.canvas.height=t.height,t.ctx=t.canvas.getContext("2d"),t.circles=[];for(let n=0;n<t.width*.5;n++){const a=new dt;t.circles.push(a)}G(),ut()};function Y(){t.animate=!(document.body.scrollTop>t.height)}function Z(){t.width=window.innerWidth,t.height=window.innerHeight,t.canvas.width=t.width,t.canvas.height=t.height}function G(){if(t.animate){t.ctx.clearRect(0,0,t.width,t.height);for(const s in t.circles)t.circles[s].draw()}t.requestId=requestAnimationFrame(G)}class dt{constructor(){w(this,"pos");w(this,"alpha");w(this,"scale");w(this,"velocity");w(this,"draw");this.pos={x:Math.random()*t.width,y:t.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random();const n=Math.random()*255,a=Math.random()*255,m=Math.random()*255;this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,t.ctx.beginPath(),t.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),t.ctx.fillStyle=`rgba(${n},${a},${m},${this.alpha})`,t.ctx.fill()}}}function ut(){window.addEventListener("scroll",Y),window.addEventListener("resize",Z)}function pt(){window.removeEventListener("scroll",Y),window.removeEventListener("resize",Z),cancelAnimationFrame(t.requestId)}const O={init:ct,removeListeners:pt},J=s=>(be("data-v-d24e70b9"),s=s(),ye(),s),mt={class:"login-container"},_t={"h-screen":"","w-screen":"",absolute:"","z-10":""},ht={class:"login-content flex-center"},gt={class:"ant-pro-form-login-main rounded"},ft={class:"flex-between h-15 px-4 mb-[2px]"},vt={class:"flex-end"},wt=J(()=>o("span",{class:"ant-pro-form-login-logo"},[o("img",{"w-full":"","h-full":"","object-cover":"",src:rt})],-1)),xt={class:"ant-pro-form-login-desc"},bt={class:"login-lang flex-center relative z-11"},yt={class:"box-border flex min-h-[520px]"},$t=J(()=>o("div",{class:"ant-pro-form-login-main-left min-h-[520px] flex-center bg-[var(--bg-color-container)]"},[o("img",{src:it,class:"h-5/6 w-5/6"})],-1)),kt={class:"ant-pro-form-login-main-right px-5 w-[335px] flex-center flex-col relative z-11"},Mt={class:"text-center py-6 text-2xl"},Ct={flex:"","items-center":""},zt={class:"mb-24px flex-between"},Lt=["data-theme"],j=60,qt=W({__name:"login",setup(s){const n=le(),a=ce(),m=de(),{layoutSetting:p}=_e(m),g=xe(),M=ue(),r=he({username:void 0,password:void 0,mobile:void 0,code:void 0,type:"account",remember:!0}),{t:l}=D(),b=E(),C=E(!1),z=E(!1),N=E(!1),P=ge(),{counter:K,pause:Q,reset:X,resume:ee,isActive:R}=fe(1e3,{controls:!0,immediate:!1,callback(f){f&&f===j&&Q()}});async function te(){C.value=!0;try{await b.value.validate(["mobile"]),setTimeout(()=>{X(),ee(),C.value=!1,n.success("验证码是：123456")},3e3)}catch{C.value=!1}}async function y(){var f;z.value=!0;try{await((f=b.value)==null?void 0:f.validate());let d;r.type==="account"?d={account:r.username,password:r.password}:d={mobile:r.mobile,code:r.code,type:"mobile"};const{data:$,code:L,message:T}=await pe(d);if(z.value=!1,L===200){M.value=$==null?void 0:$.token,a.success({message:"登录成功",description:"欢迎回来！",duration:3});const q=lt("redirect","/");g.push({path:q,replace:!0})}else a==null||a.error({message:`${L}`,description:T,duration:3}),M.value=null,g.push({path:"/login",query:{redirect:g.currentRoute.value.fullPath}}).then(()=>{})}catch(d){d instanceof me&&(N.value=!0),z.value=!1}}return ve(async()=>{await Ue(300),O.init(e(P))}),we(()=>{O.removeListeners()}),(f,d)=>{const $=at,L=Xe,T=Ye,q=ze,V=Le,U=qe,A=Ae,oe=Ee,H=Ie,se=Se,ne=Be;return u(),h("div",mt,[o("div",_t,[o("canvas",{ref_key:"bubbleCanvas",ref:P},null,512)]),o("div",ht,[o("div",gt,[o("div",ft,[o("div",vt,[wt,o("span",xt,v(e(l)("pages.layouts.userLayout.title")),1)]),o("div",bt,[o("span",{class:"flex-center cursor-pointer text-16px",onClick:d[0]||(d[0]=_=>e(m).toggleTheme(e(p).theme==="dark"?"light":"dark"))},[e(p).theme==="light"?(u(),k($,{key:0})):(u(),k(L,{key:1}))]),i(T)])]),i(q,{"m-0":""}),o("div",yt,[$t,i(q,{"m-0":"",type:"vertical",class:"ant-pro-login-divider min-h-[520px]"}),o("div",kt,[o("div",Mt,v(e(l)("pages.login.tips")),1),i(ne,{ref_key:"formRef",ref:b,model:e(r)},{default:c(()=>[e(N)&&e(r).type==="account"?(u(),k(V,{key:0,"mb-24px":"",message:e(l)("pages.login.accountLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):I("",!0),e(N)&&e(r).type==="mobile"?(u(),k(V,{key:1,"mb-24px":"",message:e(l)("pages.login.phoneLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):I("",!0),e(r).type==="account"?(u(),h(S,{key:2},[i(A,{name:"username",rules:[{required:!0,message:e(l)("pages.login.username.required")}]},{default:c(()=>[i(U,{value:e(r).username,"onUpdate:value":d[1]||(d[1]=_=>e(r).username=_),"allow-clear":"",autocomplete:"off",placeholder:e(l)("pages.login.username.placeholder"),size:"large",onPressEnter:y},{prefix:c(()=>[i(e(Ne))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),i(A,{name:"password",rules:[{required:!0,message:e(l)("pages.login.password.required")}]},{default:c(()=>[i(oe,{value:e(r).password,"onUpdate:value":d[2]||(d[2]=_=>e(r).password=_),"allow-clear":"",placeholder:e(l)("pages.login.password.placeholder"),size:"large",onPressEnter:y},{prefix:c(()=>[i(e(F))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"])],64)):I("",!0),e(r).type==="mobile"?(u(),h(S,{key:3},[i(A,{name:"mobile",rules:[{required:!0,message:e(l)("pages.login.phoneNumber.required")},{pattern:/^(86)?1([38][0-9]|4[579]|5[0-35-9]|6[6]|7[0135678]|9[89])[0-9]{8}$/,message:e(l)("pages.login.phoneNumber.invalid")}]},{default:c(()=>[i(U,{value:e(r).mobile,"onUpdate:value":d[3]||(d[3]=_=>e(r).mobile=_),"allow-clear":"",placeholder:e(l)("pages.login.phoneNumber.placeholder"),size:"large",onPressEnter:y},{prefix:c(()=>[i(e(Te))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),i(A,{name:"code",rules:[{required:!0,message:e(l)("pages.login.captcha.required")}]},{default:c(()=>[o("div",Ct,[i(U,{value:e(r).code,"onUpdate:value":d[4]||(d[4]=_=>e(r).code=_),style:{flex:"1 1 0%",transition:"width 0.3s ease 0s","margin-right":"8px"},"allow-clear":"",placeholder:e(l)("pages.login.captcha.placeholder"),size:"large",onPressEnter:y},{prefix:c(()=>[i(e(F))]),_:1},8,["value","placeholder"]),i(H,{loading:e(C),disabled:e(R),size:"large",onClick:te},{default:c(()=>[e(R)?(u(),h(S,{key:1},[x(v(j-e(K))+" "+v(e(l)("pages.getCaptchaSecondText")),1)],64)):(u(),h(S,{key:0},[x(v(e(l)("pages.login.phoneLogin.getVerificationCode")),1)],64))]),_:1},8,["loading","disabled"])])]),_:1},8,["rules"])],64)):I("",!0),o("div",zt,[i(se,{checked:e(r).remember,"onUpdate:checked":d[5]||(d[5]=_=>e(r).remember=_)},{default:c(()=>[x(v(e(l)("pages.login.rememberMe")),1)]),_:1},8,["checked"])]),i(H,{type:"primary",block:"",loading:e(z),size:"large",onClick:y},{default:c(()=>[x(v(e(l)("pages.login.submit")),1)]),_:1},8,["loading"])]),_:1},8,["model"])])])])]),o("div",{"py-24px":"","px-50px":"",fixed:"","bottom-0":"","z-11":"","w-screen":"","data-theme":e(p).theme,"text-14px":""},null,8,Lt)])}}}),Bt=B(qt,[["__scopeId","data-v-d24e70b9"]]);export{Bt as default};
